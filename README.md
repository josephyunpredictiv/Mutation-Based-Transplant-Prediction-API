# Mutation-Based Transplant Prediction API

A Flask-based API for **uploading genetic data files** and **predicting prognosis scores** using a deep learning model.

---

## ğŸš€ Features
âœ… Upload mutation-based datasets (`.txt`, `.csv`, `.vcf`)  
âœ… Validate file format before saving  
âœ… Run the deep learning model for prognosis prediction  
âœ… Automatically extract filenames for prediction  
âœ… Supports **tab-separated Digitial Twin (`txt`) files generated by Predictiv Care, Inc.**  

---

## ğŸ“¦ Installation & Setup

### **1ï¸âƒ£ Clone the Repository**
```sh
git clone https://github.com/josephyunpredictiv/Mutation-Based-Transplant-Prediction-API.git
cd mutation_based_AI_API
```

### **2ï¸âƒ£ Set Up a Virtual Environment**
```sh
python -m venv venv
source venv/bin/activate  # macOS/Linux
venv\Scripts\activate      # Windows
```

### **3ï¸âƒ£ Install Dependencies**
```sh
pip install -r requirements.txt
```

### **4ï¸âƒ£ Run the Flask Server**
```sh
python app.py
```
âœ… **API will start at** `http://127.0.0.1:5000`

---

## ğŸ“¤ Upload a File (Step 1)
### **cURL Example**
```sh
curl -X POST "http://127.0.0.1:5000/upload" \
     -F "file=@data/Digital_Twin.PRDV-XXXX-XXXX-XXXX.txt"
```

### **Python Requests Example**
```python
import requests

url = "http://127.0.0.1:5000/upload"
file_path = "data/Digital_Twin.PRDV-XXXX-XXXX-XXXX.txt"

with open(file_path, "rb") as f:
    response = requests.post(url, files={"file": f})

print(response.json())  # âœ… Expected Output: {"message": "File uploaded successfully", "file_name": "..."}
```

---

## ğŸ¯ Run Prediction (Step 2)
### **cURL Example**
```sh
curl -X POST "http://127.0.0.1:5000/predict" \
     -H "Content-Type: application/json" \
     -d '{"sample1": "Digital_Twin.PRDV-XXXX-XXXX-XXXX.txt", "sample2": "Digital_Twin.PRDV-YYYY-YYYY-YYYY.txt"}'
```

### **Python Requests Example**
```python
import requests

url = "http://127.0.0.1:5000/predict"
data = {
    "sample1": "Digital_Twin.PRDV-XXXX-XXXX-XXXX.txt",
    "sample2": "Digital_Twin.PRDV-YYYY-YYYY-YYYY.txt"
}

response = requests.post(url, json=data)
print(response.json())  # âœ… Expected Output: {"pair_id": "test", "prediction_score": 0.7345}
```

---

## ğŸ“ Expected API Responses

### **âœ… Success (Upload)**
```json
{
    "message": "File uploaded successfully",
    "file_name": "Digital_Twin.PRDV-XXXX-XXXX-XXXX.txt"
}
```

### **âœ… Success (Prediction)**
```json
{
    "pair_id": "test",
    "prediction_score": 0.7345
}
```

### **âŒ Error (Missing Required Columns)**
```json
{
    "error": "Invalid file format.",
    "details": ["Missing columns: ['Gene', 'Chromosome']"]
}
```

### **âŒ Error (File Not Found for Prediction)**
```json
{
    "error": "File not found: Digital_Twin.PRDV-XXXX-XXXX-XXXX.txt"
}
```

---

## ğŸ“Œ Directory Structure
```
mutation_based_AI_API/
â”œâ”€â”€ README.md                  # ğŸŒŸ API Documentation
â”œâ”€â”€ app.py                     # Flask API Server
â”œâ”€â”€ config.py                  # Configurations & Paths
â”œâ”€â”€ requirements.txt           # Python Dependencies
â”œâ”€â”€ data                       # Folder for dataset files
â”‚   â”œâ”€â”€ output
â”‚   â”œâ”€â”€ processed
â”‚   â””â”€â”€ raw
â”œâ”€â”€ data_preprocessing         # Folder for preprocessing code
â”œâ”€â”€ models                     # Folder for model structure
â”œâ”€â”€ testing                    # Running Model predictions
â””â”€â”€ artifacts                  # Trained Model & Encoders
    â”œâ”€â”€ encoders
    â””â”€â”€ scalers
```
